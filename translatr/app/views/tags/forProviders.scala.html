@(auth: com.feth.play.module.pa.PlayAuthenticate, providerKeys: List[String], skipCurrent: Boolean = false, showInternal: Boolean = false, showExternal: Boolean = true)(body: com.feth.play.module.pa.providers.AuthProvider => play.twirl.api.Html)

@import com.feth.play.module.pa.providers.AuthProvider.Registry

@if(providerKeys != null && providerKeys.size() > 0) {
	@defining(auth.isLoggedIn(session())) { loggedIn =>
		@defining(auth.getUser(session())) { auth =>
		    @for(k <- providerKeys) {
		    	@defining(Registry.get(k)) { p =>
			    	@if(((showExternal && p.isExternal()) || (showInternal && !p.isExternal())) && (!loggedIn || !skipCurrent || (skipCurrent && (loggedIn && !p.getKey().equals(auth.getProvider()))))) {
			    		@body(p)
			    	}
		    	}
		    }
	    }
    }
}