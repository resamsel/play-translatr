@(project: models.Project)

@import utils.FormatUtils._
@import scala.collection.JavaConversions._

@main(Messages("project.title", project.name)) {
} {
	@tags.breadcrumbs {
		<a class="breadcrumb" href="@routes.Application.dashboard()">
			@Messages("dashboard")
		</a>
		<a class="breadcrumb active" href="@routes.Application.project(project.id)">
			@project.name
		</a>
	}

	@tags.content {
		<div class="project col m12">
			@tags.projectTabs(project, "info") {
				<div class="row info">
					<!-- Project Info -->
					<div class="col m4 overview">
						<div class="card hoverable">
							<div class="card-image orange">
								<span class="card-title">@Messages("project.title", project.name)</span>
							</div>
							<div class="card-content">
								<p>
									@{Messages("timestamps.info", pretty(ctx.lang().locale, project.whenCreated), pretty(ctx.lang().locale, project.whenUpdated))}.
								</p>
							</div>
							<div class="card-action">
								<a href="@routes.Application.projectEdit(project.id)">
									@Messages("button.edit")
								</a>
								<a href="@routes.Application.projectRemove(project.id)">
									@Messages("button.remove")
								</a>
							</div>
						</div>
					</div>
	
					<!-- Locales -->
					<div class="col m4 locales">
						<div class="card hoverable">
							<div class="card-image blue">
								<span class="card-title">@Messages("locales")</span>
							</div>
							<div class="card-content">
								<p>
									@Messages("locales.size", project.locales.size()),
									@Messages("latest"):
									@{Html(models.Locale.last(project, 3).map(l => tags.localeLink(l)).mkString(", "))}.
								</p>
								<div class="progress">
									<div class="progress-bar progress-bar-success" style="width: @{project.progress()*100}%;"></div>
								</div>
							</div>
						</div>
					</div>
	
					<!-- Keys -->
					<div class="col m4 keys">
						<div class="card hoverable">
							<div class="card-image light-green">
								<span class="card-title">@Messages("keys")</span>
							</div>
							<div class="card-content">
								<p>
									@Messages("keys.size", project.keys.size()),
									@Messages("latest"):
									@{Html(models.Key.last(project, 3).map(k => tags.keyLink(k)).mkString(", "))}.
								</p>
							</div>
						</div>
					</div>

					<!-- Messages -->
					<div class="col m12 messages">
						<div class="card hoverable">
							<div class="card-image red">
								<span class="card-title">@Messages("messages")</span>
							</div>
							<div class="card-content">
								<p>
									@Messages("messages.size", project.messagesSize()),
									@Messages("latest"):
									@{Html(models.Message.last(project, 3).map(m => tags.messageLink(m)).mkString(", "))}.
								</p>
							</div>
						</div>
					</div>

					<!-- Timeline -->
					<div class="col m12 timeline">
						<div class="card hoverable">
							<div class="card-image grey">
								<span class="card-title">@Messages("timeline")</span>
							</div>
							<div class="card-content">
								<div id="chart-timeline" class="ct-chart ct-double-octave"></div>
							</div>
						</div>
					</div>
				</div>
			}
		</div>
		<!-- /.col-md-12 -->
	}

	<link rel="stylesheet" media="screen" href="@routes.Assets.versioned("stylesheets/chartist.min.css")">
	<script src="@routes.Assets.versioned("javascripts/chartist.min.js")"></script>
	<script src="@routes.Assets.versioned("javascripts/moment.min.js")"></script>
	<script>
		var data = {
			series: [{
				name: 'messages',
				data: [
					@for(stat <- utils.StatUtils.getMessageStats(project)) {
						{x: new Date(@stat.millis), y: @stat.value},
					}
				]
			}, {
				name: 'keys',
				data: [
					@for(stat <- utils.StatUtils.getKeyStats(project)) {
						{x: new Date(@stat.millis), y: @stat.value},
					}
				]
			}, {
				name: 'locales',
				data: [
					@for(stat <- utils.StatUtils.getLocaleStats(project)) {
						{x: new Date(@stat.millis), y: @stat.value},
					}
				]
			}]
		};

		var options = {
			chartPadding: {
				left: -10,
				bottom: -10
			},
			stackBars: true,
			axisX: {
				type: Chartist.FixedScaleAxis,
				divisor: 8,
				labelInterpolationFnc: function(value) {
					return moment(value).format('MMM D, HH:00');
				},
				showGrid: false
			},
			axisY: {
				onlyInteger: true,
				showGrid: false
			}
		};

		new Chartist.Bar('#chart-timeline', data, options);
	</script>
}