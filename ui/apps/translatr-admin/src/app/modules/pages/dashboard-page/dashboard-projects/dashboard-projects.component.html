<div class="container">
  <div>
    <entity-table
      [dataSource]="projects$ | async"
      [displayedColumns]="displayedColumns"
      [load]="load$ | async"
      (criteria)="onCriteriaChanged($event)"
      (selected)="onSelected($event)"
    >
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Name</th>
        <td mat-cell *matCellDef="let element">
          <a
            class="link"
            href="/ui/{{ element.ownerUsername }}/{{ element.name }}"
            >{{ element.name }}</a
          >
        </td>
      </ng-container>

      <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef>Description</th>
        <td mat-cell *matCellDef="let element">
          {{ element.description | slice: 0:16 }}
        </td>
      </ng-container>

      <ng-container matColumnDef="owner">
        <th mat-header-cell *matHeaderCellDef>Owner</th>
        <td mat-cell *matCellDef="let element">
          <a class="link" href="/ui/{{ element.ownerUsername }}">{{
            element.ownerName
          }}</a>
        </td>
      </ng-container>

      <ng-container matColumnDef="when_created">
        <th mat-header-cell *matHeaderCellDef>Created</th>
        <td
          mat-cell
          *matCellDef="let element"
          [title]="element.whenCreated | date: 'full'"
        >
          {{ element.whenCreated | amTimeAgo }}
        </td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef class="actions">Actions</th>
        <td mat-cell *matCellDef="let element" class="actions">
          <button
            mat-icon-button
            [disabled]="!(allowEdit$(element) | async)"
            (click)="onEdit(element)"
          >
            <mat-icon>edit</mat-icon>
          </button>
          <confirm-button
            title="Delete"
            icon="delete"
            [disabled]="!(allowDelete$(element) | async)"
            (confirm)="onDelete(element)"
          >
          </confirm-button>
        </td>
      </ng-container>

      <selection-actions>
        <confirm-button
          title="Delete selected"
          icon="delete"
          [disabled]="!(allowDeleteAll$(selected) | async)"
          (confirm)="onDeleteAll(selected)"
        ></confirm-button>
      </selection-actions>
    </entity-table>
  </div>
</div>
